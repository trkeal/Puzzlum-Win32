
sub ln_actnrapl ()
    MID(e_stra(Rose_Calc( Tx_si, Ty_si ), 4), 1, 4) = "pnch"
    MID(e_stra(Rose_Calc( Tx_si, Ty_si ), 4), 5, 4) = "grpl"
    IF dis_si = 1 THEN
        action_str = "____pwch"
        dis_si = 0
        ln_putaction
        MID(e_stra(Rose_Calc( Tx_si, Ty_si ), 4), 1, 4) = "____"
        MID(e_stra(Rose_Calc( Tx_si, Ty_si ), 4), 5, 4) = "____"
        Exit Sub
    END IF
    blankcheck_str = "____pwch"
    ln_blankcheck
    IF blankcheck_si = -1 THEN
        IF dis_si > 1 THEN
            dis_si = dis_si - 1
            ln_putaction
        END IF
        Exit Sub
    END IF
    IF blankcheck_si > 0 THEN
        IF dis_si > 1 THEN
            dis_si = dis_si - 1
            ln_putaction
        END IF
    END IF
    blankcheck_str = attackthem_str
    ln_blankcheck
    IF blankcheck_si > 0 THEN
        ln_attklash
        dis_si = dis_si - 1
        ln_putaction
        Exit Sub
    END IF
    blankcheck_str = "bldrchst"
    ln_blankcheck
    IF blankcheck_si > 0 THEN
        dis_si = 1
        blankcheck_str = "____pwch"
        ln_blankcheck
        IF blankcheck_si = 0 THEN
            dis_si = dis_si - 1
            ln_putaction
            Exit Sub
        END IF
        IF blankcheck_si > 0 THEN
            IF Tx_si = ex_si AND Ty_si = dy_si THEN
                am_str = ctrl_str
                ln_am
                IF am_si > 0 THEN
                    ex_si = Tx_si + d_sia(d_si, 1) * dis_si
                    dy_si = Ty_si + d_sia(d_si, 2) * dis_si
                END IF
            END IF
            ln_swapdata
            temptx_si = Tx_si
            tempty_si = Ty_si
            Tx_si = Tx_si + d_sia(d_si, 1)
            Ty_si = Ty_si + d_sia(d_si, 2)
            ln_getaction
            dis_si = dis_si - 1
            ln_putaction
            Tx_si = temptx_si
            Ty_si = tempty_si
            Exit Sub
        END IF
    END IF
    Exit Sub
end sub
